# README

## â‘  èª²é¡Œå

**Simple Deal Manager v1.3 â€“ PHP & MySQL CRUD + Data Visualization + Login Auth App**

---

## â‘¡ èª²é¡Œå†…å®¹ï¼ˆã©ã‚“ãªä½œå“ã‹ï¼‰

é¡§å®¢æƒ…å ±ã¨æ¡ˆä»¶ï¼ˆDealï¼‰ãƒ‡ãƒ¼ã‚¿ã‚’ç™»éŒ²ãƒ»ç®¡ç†ã§ãã‚‹
**ã‚·ãƒ³ãƒ—ãƒ«ãªæ¥­å‹™ãƒ‡ãƒ¼ã‚¿ç®¡ç†ã‚¢ãƒ—ãƒª**ã§ã™ã€‚

æœ¬èª²é¡Œã§ã¯ã€PHPã¨MySQLã‚’ç”¨ã„ãŸCRUDå‡¦ç†ã®ç†è§£ã«åŠ ãˆã€
å‡¦ç†ã”ã¨ã®è²¬å‹™åˆ†é›¢ã‚’æ„è­˜ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆãƒ»å®Ÿè£…æ•´ç†ã«ã‚‚æ³¨åŠ›ã—ã¾ã—ãŸã€‚

DBæ¥ç¶šå‡¦ç†ã€ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»æ›´æ–°å‡¦ç†ã€è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ã‚’æ˜ç¢ºã«åˆ†é›¢ã—ã€
æ©Ÿèƒ½è¿½åŠ ã‚„ä¿®æ­£æ™‚ã«ã‚‚å½±éŸ¿ç¯„å›²ã‚’é™å®šã§ãã‚‹æ§‹æˆã¨ã—ã¦ã„ã¾ã™ã€‚

ç‰¹ã« v1.1 ã§ã¯ã€

* DBæ¥ç¶šå‡¦ç†ã®é–¢æ•°åŒ–
* ç·¨é›†ç”»é¢ã¨æ›´æ–°å‡¦ç†ã®åˆ†é›¢
* å‡¦ç†å°‚ç”¨PHPãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®å½¹å‰²åˆ†æ‹…

ã‚’è¡Œã„ã€**ã€Œå‹•ãã€ã ã‘ã§ãªãã€Œä¿å®ˆã—ã‚„ã™ã„CRUDæ§‹æˆã€**ã‚’æ„è­˜ã—ãŸè¨­è¨ˆã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¾ã—ãŸã€‚

ã¾ãŸ v1.2 ã§ã¯ã€æ¡ˆä»¶ãƒ»é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã‚’ **é›†è¨ˆãƒ»å¯è¦–åŒ–ã™ã‚‹æ©Ÿèƒ½** ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚
é¡§å®¢ãƒã‚¹ã‚¿ã¨æ¡ˆä»¶ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ JOIN ã—ã€é¡§å®¢åˆ¥å£²ä¸Šã‚’é›†è¨ˆã—ãŸçµæœã‚’
**Chart.js ã‚’ç”¨ã„ãŸã‚°ãƒ©ãƒ•è¡¨ç¤ºãƒšãƒ¼ã‚¸ã¨ã—ã¦ç‹¬ç«‹å®Ÿè£…**ã—ã¦ã„ã¾ã™ã€‚

ãã—ã¦ v1.3 ã§ã¯ã€
**ãƒ­ã‚°ã‚¤ãƒ³èªè¨¼ãƒ»æ¨©é™åˆ¶å¾¡ï¼ˆç®¡ç†è€…å°‚ç”¨ç”»é¢ï¼‰** ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚

* ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ç®¡ç†ï¼ˆãƒ­ã‚°ã‚¤ãƒ³å¿…é ˆãƒšãƒ¼ã‚¸åˆ¶å¾¡ï¼‰
* æ¨©é™ãƒ•ãƒ©ã‚°ï¼ˆ`u_role_flg`ï¼‰ã«ã‚ˆã‚‹ç®¡ç†è€…å°‚ç”¨ãƒšãƒ¼ã‚¸åˆ¶å¾¡
* ãƒ¦ãƒ¼ã‚¶ãƒ¼æœ‰åŠ¹/ç„¡åŠ¹ï¼ˆ`u_life_flg`ï¼‰ã«ã‚ˆã‚‹ãƒ­ã‚°ã‚¤ãƒ³å¯å¦åˆ¤å®š
* **ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ç”»é¢ï¼ˆadmin_users.phpï¼‰** ã®è¿½åŠ 

---

## â‘¢ ã‚¢ãƒ—ãƒªã®ãƒ‡ãƒ—ãƒ­ã‚¤URL

**ã‚¢ãƒ—ãƒªURL**
[https://www.logic-craft.jp/bookmark-app/index.php](https://www.logic-craft.jp/bookmark-app/index.php)

---

## â‘£ ã‚¢ãƒ—ãƒªã«ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ãŒã‚ã‚‹å ´åˆ

ã‚ã‚Šï¼ˆv1.3ã§ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã‚’è¿½åŠ ï¼‰

æœ¬ã‚¢ãƒ—ãƒªã§ã¯ã€`user_master` ãƒ†ãƒ¼ãƒ–ãƒ«ã«ç™»éŒ²ã•ã‚ŒãŸ
ãƒ¦ãƒ¼ã‚¶ãƒ¼IDï¼ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç”¨ã„ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã™ã€‚
æ¨©é™ãƒ•ãƒ©ã‚°ãŠã‚ˆã³æœ‰åŠ¹ï¼ç„¡åŠ¹ãƒ•ãƒ©ã‚°ã«ã‚ˆã£ã¦ã€ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªç”»é¢ã‚’åˆ¶å¾¡ã—ã¦ã„ã¾ã™ã€‚

### ãƒ†ã‚¹ãƒˆç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ

* **ç®¡ç†è€…æ¨©é™ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**
  IDï¼š`test1` / PWï¼š`test1`

* **ä¸€èˆ¬æ¨©é™ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**
  IDï¼š`test2` / PWï¼š`test2`

* **ä¸€èˆ¬æ¨©é™ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆç„¡åŠ¹ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰**
  IDï¼š`test3` / PWï¼š`test3`
  â€»æœ‰åŠ¹ãƒ•ãƒ©ã‚°ãŒç„¡åŠ¹ã®ãŸã‚ã€ãƒ­ã‚°ã‚¤ãƒ³ä¸å¯

---

## â‘¤ ã“ã ã‚ã£ãŸç‚¹

### â–  å‡¦ç†ã”ã¨ã®è²¬å‹™åˆ†é›¢ã‚’æ„è­˜ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆï¼ˆv1.1ï¼‰

æœ¬ã‚¢ãƒ—ãƒªã§ã¯ã€**ã€Œ1ãƒ•ã‚¡ã‚¤ãƒ«ï¼1è²¬å‹™ã€** ã‚’æ„è­˜ã—ã¦PHPãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´ç†ã—ã¦ã„ã¾ã™ã€‚
ç‰¹ã« v1.1 ã§ã¯CRUDä¸€é€£ã®æµã‚Œã‚’æ•´ç†ã—ç›´ã—ã€**å½¹å‰²ãŒæ›–æ˜§ã«ãªã‚Šã‚„ã™ã„å‡¦ç†ã‚’æ˜ç¤ºçš„ã«åˆ†é›¢**ã—ã¾ã—ãŸã€‚

---

### â–  DBæ¥ç¶šå‡¦ç†ã®é–¢æ•°åŒ–ï¼ˆdb_connï¼‰ -- v1.1 Update

DBæ¥ç¶šå‡¦ç†ã‚’ `inc/functions.php` ã® `db_conn()` ã«é–¢æ•°åŒ–ã—ã€
å„å‡¦ç†ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å…±é€šã§å‘¼ã³å‡ºã›ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚
æ¥ç¶šæƒ…å ±ï¼ˆå®šæ•°ï¼‰ã¯ `config/db.php` ã«é›†ç´„ã—ã€å½¹å‰²åˆ†é›¢ã‚’æ„è­˜ã—ã¦ã„ã¾ã™ã€‚

---

### â–  æ¡ˆä»¶ã®æ›´æ–°ï¼ˆUPDATEï¼‰æ©Ÿèƒ½ã®è¿½åŠ  -- v1.1 Update

ä¸€è¦§ã‹ã‚‰ç·¨é›†ãƒªãƒ³ã‚¯ã§ `deal_edit.php?d_id=...` ã«é·ç§»ã—ã€
è©²å½“ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚©ãƒ¼ãƒ ã«åˆæœŸè¡¨ç¤º â†’ `deal_update_action.php` ã¸POST â†’ UPDATE ã®æµã‚Œã§æ›´æ–°å‡¦ç†ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚
æ›´æ–°å¯¾è±¡IDã¯ hidden ã§æ¸¡ã—ã€WHEREå¥ã§å¯¾è±¡ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’é™å®šã—ã¦ã„ã¾ã™ã€‚

---

### â–  ãƒ‡ãƒ¼ã‚¿é›†è¨ˆãƒ»å¯è¦–åŒ–ãƒšãƒ¼ã‚¸ã®è¿½åŠ  -- v1.2 Update

v1.2 ã§ã¯é¡§å®¢åˆ¥å£²ä¸Šã‚’é›†è¨ˆãƒ»å¯è¦–åŒ–ã™ã‚‹ãŸã‚ã®ã‚°ãƒ©ãƒ•å°‚ç”¨ãƒšãƒ¼ã‚¸ï¼ˆ`sales_chart.php`ï¼‰ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚

é¡§å®¢ãƒã‚¹ã‚¿ï¼ˆcustomer_masterï¼‰ã¨æ¡ˆä»¶ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆdeal_masterï¼‰ã‚’ **LEFT JOIN** ã—ã€
å£²ä¸ŠãŒæœªç™»éŒ²ã®é¡§å®¢ã‚‚å«ã‚ã¦é›†è¨ˆã—ã¦ã„ã¾ã™ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€Œå£²ä¸ŠãŒã¾ã ç™ºç”Ÿã—ã¦ã„ãªã„é¡§å®¢ã€ã‚‚ 0 å††ã¨ã—ã¦å¯è¦–åŒ–ã§ãã¾ã™ã€‚

---

### â–  ã‚°ãƒ©ãƒ•æç”»ã«ãŠã‘ã‚‹è²¬å‹™åˆ†é›¢ -- v1.2 Update

* PHPï¼šãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»é›†è¨ˆãƒ»JSONåŒ–ï¼ˆ`window.salesChartData` ã¨ã—ã¦æ¸¡ã™ï¼‰
* JavaScriptï¼šChart.js ã«ã‚ˆã‚‹æç”»ï¼ˆmoduleï¼‰
* CSSï¼šã‚°ãƒ©ãƒ•å°‚ç”¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆ`chart.css`ï¼‰

ã¨å½¹å‰²åˆ†æ‹…ã—ã¦å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

JavaScript ã¯ `assets/js/renderSalesChart.js` ã¨ã—ã¦åˆ‡ã‚Šå‡ºã—ã€
`sales_chart.php` å´ã§ `<script type="module">` ã«ã‚ˆã‚Š import ã—ã€æç”»é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ã„ã¾ã™ã€‚

---

### â–  ãƒ­ã‚°ã‚¤ãƒ³èªè¨¼ãƒ»æ¨©é™åˆ¶å¾¡ï¼ˆç®¡ç†è€…å°‚ç”¨ç”»é¢ï¼‰ -- v1.3 Update

v1.3 ã§ã¯ã€ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ï¼ˆ`login.php`ï¼‰ã¨èªè¨¼å‡¦ç†ï¼ˆ`login_action.php`ï¼‰ã‚’è¿½åŠ ã—ã€
**ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ãŸãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ç®¡ç†**ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚

åŸºæœ¬è¨­è¨ˆã¨ã—ã¦ã€ãƒ­ã‚°ã‚¤ãƒ³å¿…é ˆãƒšãƒ¼ã‚¸ã« `require_login()` ã‚’é©ç”¨ã—ã€
**URLç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆç›´å©ãï¼‰ã‚’åˆ¶å¾¡**ã—ã¦ã„ã¾ã™ã€‚

ã•ã‚‰ã«ç®¡ç†è€…å°‚ç”¨ãƒšãƒ¼ã‚¸ã«ã¤ã„ã¦ã¯ `require_admin()` ã‚’ç”¨ã„ã¦åˆ¶å¾¡ã—ã€

* **ã‚µãƒ¼ãƒãƒ¼å´**ï¼š`require_admin()` ã«ã‚ˆã‚‹æ¨©é™ãƒã‚§ãƒƒã‚¯
  ï¼ˆ`require_login()` ã‚’å†…åŒ…ã—ã€ãƒ­ã‚°ã‚¤ãƒ³æœªæ¸ˆã‚‚åŒæ™‚ã«é®æ–­ï¼‰
* **UIå´**ï¼šæ¨©é™ãƒ•ãƒ©ã‚°ï¼ˆ`u_role_flg`ï¼‰ã«å¿œã˜ã¦ç®¡ç†è€…å°‚ç”¨ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’éè¡¨ç¤º

ã¨ã„ã† **äºŒæ®µæ§‹ãˆ** ã«ã—ã¦ã„ã¾ã™ã€‚

ã“ã‚Œã«ã‚ˆã‚Šã€
ã€Œç”»é¢è¡¨ç¤ºã®åˆ¶å¾¡ã€ã¨ã€Œã‚µãƒ¼ãƒãƒ¼å´ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã€ã‚’åˆ†é›¢ã—ã€
**UIæ“ä½œãƒ»URLç›´æ¥æŒ‡å®šã®ä¸¡æ–¹ã‹ã‚‰ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ã‚’é˜²ãæ§‹æˆ**ã¨ã—ã¦ã„ã¾ã™ã€‚

---

### â–  ç®¡ç†è€…å‘ã‘ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ç”»é¢ã®è¿½åŠ ï¼ˆv1.3 Updateï¼‰

ç®¡ç†è€…ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãª **ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ç”»é¢ï¼ˆ`admin_users.php`ï¼‰** ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚
`user_master` ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ï¼ˆIDï¼ãƒ­ã‚°ã‚¤ãƒ³IDï¼ãƒ­ãƒ¼ãƒ«ï¼çŠ¶æ…‹ï¼‰ã‚’ä¸€è¦§è¡¨ç¤ºã—ã€
æ¨©é™åˆ¶å¾¡ï¼ˆAdmin / Userï¼‰ã¨çŠ¶æ…‹ï¼ˆActive / Disabledï¼‰ã®ç¢ºèªã‚’å¯èƒ½ã«ã—ã¦ã„ã¾ã™ã€‚

---

### â–  å…±é€šãƒ˜ãƒƒãƒ€ãƒ¼ã®éƒ¨å“åŒ–ï¼ˆheader.phpï¼‰

å…±é€šUIã¨ã—ã¦ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ `inc/header.php` ã«ã¾ã¨ã‚ã€å„ãƒšãƒ¼ã‚¸ã‹ã‚‰ `include` ã§å†åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®è¿½åŠ ãƒ»ä¿®æ­£ã‚’1ç®‡æ‰€ã§ç®¡ç†ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

ã¾ãŸã€ã‚¹ãƒãƒ›è¡¨ç¤ºã§ã¯ãƒ˜ãƒƒãƒ€ãƒ¼å†…ãƒœã‚¿ãƒ³ãŒæ½°ã‚Œãªã„ã‚ˆã†ã«
ãƒ˜ãƒƒãƒ€ãƒ¼ãŒæŠ˜ã‚Šè¿”ã—å¯èƒ½ãªè¨­è¨ˆã«èª¿æ•´ã—ã¾ã—ãŸï¼ˆflex-wrapå¯¾å¿œï¼‰ã€‚  

---

## â‘¥ é›£ã—ã‹ã£ãŸç‚¹ãƒ»æ¬¡å›ãƒˆãƒ©ã‚¤ã—ãŸã„ã“ã¨

### â–  é›£ã—ã‹ã£ãŸç‚¹

* CRUDå‡¦ç†ã®è²¬å‹™æ•´ç†ï¼ˆDBæ¥ç¶šå‡¦ç†ã®é–¢æ•°åŒ–ã€ç·¨é›†ç”»é¢ã¨æ›´æ–°å‡¦ç†ã®åˆ†é›¢ï¼‰
* ç·¨é›†ç”»é¢ã§ã®åˆæœŸå€¤åæ˜ ï¼ˆvalue / selected / hidden ã‚’ç”¨ã„ãŸãƒ•ã‚©ãƒ¼ãƒ åˆ¶å¾¡ï¼‰
* JOINã«ã‚ˆã‚‹ä¸€è¦§è¡¨ç¤ºãƒ»é›†è¨ˆå‡¦ç†ã®æ•´ç†
* ãƒ­ã‚°ã‚¤ãƒ³èªè¨¼ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼‰ã¨æ¨©é™åˆ¶å¾¡ã®è¨­è¨ˆï¼ˆv1.3ï¼‰
* ç®¡ç†è€…å°‚ç”¨ç”»é¢ã®å°ç·šã¨åˆ¶å¾¡ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ç”»é¢è¿½åŠ ï¼‰

---

### â–  æ¬¡å›ãƒˆãƒ©ã‚¤ã—ãŸã„ã“ã¨

* ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®å¼·åŒ–
* ã‚½ãƒ¼ãƒˆãƒ»ãƒ•ã‚£ãƒ«ã‚¿æ©Ÿèƒ½ã®æ‹¡å¼µ
* èªè¨¼ã®å¼·åŒ–ï¼ˆCSRFå¯¾ç­–ã€ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—å›æ•°åˆ¶é™ãªã©ï¼‰
* DBè¨­è¨ˆã®æ‹¡å¼µï¼ˆå¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ãªã©ï¼‰
* å¯è¦–åŒ–ãƒšãƒ¼ã‚¸ã®æ‹¡å¼µï¼ˆæœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ã€ãƒ©ãƒ³ã‚­ãƒ³ã‚°è¡¨ç¤ºãªã©ï¼‰

---

## â‘¦ ãƒ•ãƒªãƒ¼é …ç›®

ä»Šå›ã¯ç™»éŒ²ãƒ»ä¸€è¦§è¡¨ç¤ºã ã‘ã§çµ‚ã‚ã‚‰ã›ãšã€
ç·¨é›†ï¼ˆEDITï¼‰ãƒ»æ›´æ–°ï¼ˆUPDATEï¼‰ã¾ã§å«ã‚ãŸCRUDä¸€é€£ã®æµã‚Œã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚

ã¾ãŸ v1.2 ã§é›†è¨ˆãƒ»å¯è¦–åŒ–ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ ã—ã€
v1.3 ã§ãƒ­ã‚°ã‚¤ãƒ³èªè¨¼ãƒ»æ¨©é™åˆ¶å¾¡ï¼ˆç®¡ç†è€…å°‚ç”¨ç”»é¢ï¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ç”»é¢ï¼‰ã¾ã§æ‹¡å¼µã™ã‚‹ã“ã¨ã§ã€
æ¥­å‹™ã‚¢ãƒ—ãƒªã¨ã—ã¦ã®åŸºæœ¬æ§‹æˆã‚’æ®µéšçš„ã«åºƒã’ã¦ã„ã¾ã™ã€‚

---

---

# ğŸ—‚ Simple Deal Manager â€“ README

## ğŸ“ æ¦‚è¦ï¼ˆOverviewï¼‰

**Simple Deal Manager** ã¯ã€é¡§å®¢æƒ…å ±ã¨æ¡ˆä»¶ï¼ˆDealï¼‰ãƒ‡ãƒ¼ã‚¿ã‚’ç™»éŒ²ãƒ»ç®¡ç†ã™ã‚‹
**ã‚·ãƒ³ãƒ—ãƒ«ãªæ¥­å‹™ãƒ‡ãƒ¼ã‚¿ç®¡ç†ã‚¢ãƒ—ãƒª**ã§ã™ã€‚

æœ¬èª²é¡Œã§ã¯ã€
**PHPã¨MySQLã‚’ç”¨ã„ãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œï¼ˆCRUDï¼‰ã®ç†è§£**ã‚’ä¸»ç›®çš„ã¨ã—ã€
ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›ã‹ã‚‰DBç™»éŒ²ã€ä¸€è¦§è¡¨ç¤ºã€ç·¨é›†ã€å‰Šé™¤ã¾ã§ã®ä¸€é€£ã®æµã‚Œã‚’
æœ€å°æ§‹æˆã§å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

ğŸ”¹ **V1.1**
è²¬å‹™åˆ†é›¢ã‚’æ„è­˜ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆã‚’å†æ•´ç†ã—ã€CRUDä¸€é€£ã®æ“ä½œï¼ˆUPDATEå«ã‚€ï¼‰ã‚’å®Ÿè£…ã€‚

ğŸ”¹ **V1.2**
é¡§å®¢åˆ¥å£²ä¸Šã‚’é›†è¨ˆã—ã€**Chart.js ã«ã‚ˆã‚‹å¯è¦–åŒ–ãƒšãƒ¼ã‚¸ã‚’è¿½åŠ **ã€‚

ğŸ”¹ **V1.3**
ãƒ­ã‚°ã‚¤ãƒ³èªè¨¼ã‚’å°å…¥ã—ã€**ãƒ­ã‚°ã‚¤ãƒ³å¿…é ˆãƒšãƒ¼ã‚¸ãƒ»ç®¡ç†è€…å°‚ç”¨ãƒšãƒ¼ã‚¸åˆ¶å¾¡**ã‚’å®Ÿè£…ã€‚
ã•ã‚‰ã«ã€ç®¡ç†è€…å‘ã‘ã® **ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ç”»é¢ï¼ˆadmin_users.phpï¼‰** ã‚’è¿½åŠ ã—ã€
æ¨©é™ãƒ»çŠ¶æ…‹ã®ä¸€è¦§è¡¨ç¤ºã‚’å¯èƒ½ã«ã—ã¾ã—ãŸã€‚

---

## ğŸ¯ ãƒ†ãƒ¼ãƒãƒ»å­¦ç¿’ç›®çš„

* PHPã«ã‚ˆã‚‹ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ãƒ»å—ä¿¡å‡¦ç†
* MySQLï¼ˆPDOï¼‰ã‚’ç”¨ã„ãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ
* CRUDï¼ˆCreate / Read / Update / Deleteï¼‰ã®åŸºæœ¬å®Ÿè£…
* å‡¦ç†ã”ã¨ã®è²¬å‹™åˆ†é›¢ã‚’æ„è­˜ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«è¨­è¨ˆ
* include ã‚’ç”¨ã„ãŸå…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®åˆ†é›¢
* CSSã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆã«ã‚ˆã‚‹UIæ•´ç†
* é›†è¨ˆçµæœã®å¯è¦–åŒ–ï¼ˆChart.jsï¼‰
* ãƒ­ã‚°ã‚¤ãƒ³èªè¨¼ãƒ»æ¨©é™åˆ¶å¾¡ã®åŸºæœ¬è¨­è¨ˆï¼ˆV1.3ï¼‰

---

## ğŸ“‹ æ©Ÿèƒ½ä¸€è¦§ï¼ˆFeaturesï¼‰

### â–¼ Dealç®¡ç†ï¼ˆDealï¼‰

* æ¡ˆä»¶ãƒ‡ãƒ¼ã‚¿ã®ç™»éŒ²
* é¡§å®¢ Ã— æ¡ˆä»¶ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ„è­˜ã—ãŸè¨­è¨ˆ
* ä¸€è¦§è¡¨ç¤ºï¼ˆJOINï¼‰
* ç·¨é›†ï¼æ›´æ–°ï¼ˆUPDATEï¼‰
* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã«ã‚ˆã‚‹è¤‡æ•°å‰Šé™¤

### â–¼ Customerç®¡ç†ï¼ˆAdmin Onlyï¼‰

* é¡§å®¢æƒ…å ±ã®ç™»éŒ²
* é¡§å®¢ä¸€è¦§è¡¨ç¤º
  â€»ç®¡ç†è€…ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ï¼ˆ`require_admin()`ï¼‰

### â–¼ é¡§å®¢åˆ¥å£²ä¸Šã‚°ãƒ©ãƒ•ï¼ˆV1.2ï¼‰

* é¡§å®¢åˆ¥å£²ä¸Šã®é›†è¨ˆï¼ˆLEFT JOINï¼‰
* å£²ä¸Š0ã®é¡§å®¢ã‚‚å«ã‚ã¦è¡¨ç¤º
* Chart.js ã«ã‚ˆã‚‹ã‚°ãƒ©ãƒ•æç”»
* JSæç”»ãƒ­ã‚¸ãƒƒã‚¯ã‚’ `assets/js/renderSalesChart.js` ã«åˆ†é›¢

### â–¼ ãƒ­ã‚°ã‚¤ãƒ³èªè¨¼ãƒ»æ¨©é™åˆ¶å¾¡ï¼ˆV1.3ï¼‰

* ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã«ã‚ˆã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼
* ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ç®¡ç†
* æœ‰åŠ¹ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆ`u_life_flg = 0`ï¼‰ã®ã¿ãƒ­ã‚°ã‚¤ãƒ³å¯èƒ½
* æ¨©é™ãƒ•ãƒ©ã‚°ï¼ˆ`u_role_flg`ï¼‰ã«ã‚ˆã‚‹ç®¡ç†è€…å°‚ç”¨ãƒšãƒ¼ã‚¸åˆ¶å¾¡

### â–¼ ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ç”»é¢ï¼ˆAdmin Only / V1.3ï¼‰

* `user_master` ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ä¸€è¦§è¡¨ç¤º
* ãƒ­ãƒ¼ãƒ«ï¼ˆAdmin / Userï¼‰ã¨çŠ¶æ…‹ï¼ˆActive / Disabledï¼‰ã‚’è¡¨ç¤º
  â€»ç®¡ç†è€…ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ï¼ˆ`require_admin()`ï¼‰

---

## ğŸ”§ è¨­è¨ˆãƒ»æ§‹æˆã®ãƒã‚¤ãƒ³ãƒˆ

æœ¬ã‚¢ãƒ—ãƒªã§ã¯ã€**å‡¦ç†ã”ã¨ã®è²¬å‹™åˆ†é›¢ã¨å¯èª­æ€§**ã‚’é‡è¦–ã—ãŸæ§‹æˆã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

* DBæ¥ç¶šæƒ…å ±ã¯ `config/db.php` ã«é›†ç´„
* DBæ¥ç¶šå‡¦ç†ã¯ `db_conn()` ã¨ã—ã¦é–¢æ•°åŒ–ï¼ˆ`inc/functions.php`ï¼‰
* XSSå¯¾ç­–ã® `h()` ãªã©å…±é€šé–¢æ•°ã‚’é›†ä¸­ç®¡ç†
* ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ `inc/header.php` ã¨ã—ã¦å…±é€šåŒ–
* CSSã¯UIã®å½¹å‰²ã”ã¨ã«åˆ†å‰²ï¼ˆbutton / form / table / chart / loginï¼‰
* ã‚¹ãƒãƒ›æ™‚ã®ãƒ˜ãƒƒãƒ€ãƒ¼å´©ã‚Œã‚’é˜²ããŸã‚æŠ˜ã‚Šè¿”ã—è¨­è¨ˆã‚’èª¿æ•´  
* Chartæç”»ã¯ã€ŒPHPé›†è¨ˆ â†’ JSæç”» â†’ CSSãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€ã§è²¬å‹™åˆ†é›¢
* ãƒ†ãƒ¼ãƒ–ãƒ«UIã¯å…±é€šã‚¹ã‚¿ã‚¤ãƒ«ã¨ã—ã¦ç®¡ç†ï¼ˆdeal/usersã§èª¿æ•´ï¼‰ 
* UIãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆrootå¤‰æ•°ï¼‰ã«ã‚ˆã‚‹ä¸€æ‹¬ãƒ‡ã‚¶ã‚¤ãƒ³åˆ¶å¾¡ 

---

## ğŸ›  æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ï¼ˆTech Stackï¼‰

* HTML
* CSS
* PHP
* MySQL
* Chart.js

---

## ğŸ—‚ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
assets/
â”œâ”€ css/
â”‚  â”œâ”€ buttons.css          // ãƒœã‚¿ãƒ³UI
â”‚  â”œâ”€ chart.css            // ã‚°ãƒ©ãƒ•å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆv1.2ï¼‰
â”‚  â”œâ”€ form.css             // ãƒ•ã‚©ãƒ¼ãƒ UI
â”‚  â”œâ”€ login.css            // ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆv1.3ï¼‰
â”‚  â”œâ”€ responsive.css       // ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ
â”‚  â”œâ”€ scroll.css           // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«UI
â”‚  â”œâ”€ style.css            // å…±é€šã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆrootå¤‰æ•°å«ã‚€ï¼‰
â”‚  â””â”€ table.css            // ãƒ†ãƒ¼ãƒ–ãƒ«UI
â””â”€ js/
   â””â”€ renderSalesChart.js  // Chartæç”»ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆv1.2ï¼‰

config/
â”œâ”€ .htaccess
â””â”€ db.php                  // DBæ¥ç¶šæƒ…å ±

inc/
â”œâ”€ functions.php           // å…±é€šé–¢æ•°ï¼ˆh(), db_conn(), redirect(), èªè¨¼ç³»require_*ï¼‰
â””â”€ header.php              // å…±é€šãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆæ—§ header.htmlï¼‰

tools/                     // â€»ignoreï¼ˆé–‹ç™ºè£œåŠ©ï¼‰
â””â”€ make_hash.php           // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥ç”Ÿæˆ

deals_list.php             // æ¡ˆä»¶ç®¡ç†ï¼ˆç™»éŒ²ãƒ»ä¸€è¦§ãƒ»ç·¨é›†å°ç·šãƒ»å‰Šé™¤ï¼‰
deal_create_action.php     // æ¡ˆä»¶ç™»éŒ²å‡¦ç†
deal_edit.php              // æ¡ˆä»¶ç·¨é›†ç”»é¢ï¼ˆv1.1ï¼‰
deal_update_action.php     // æ¡ˆä»¶æ›´æ–°å‡¦ç†ï¼ˆv1.1ï¼‰
deal_delete_action.php     // æ¡ˆä»¶å‰Šé™¤å‡¦ç†

customers_list.php         // é¡§å®¢ç®¡ç†ï¼ˆç®¡ç†è€…å°‚ç”¨ï¼‰
customer_create_action.php // é¡§å®¢ç™»éŒ²å‡¦ç†

sales_chart.php            // é¡§å®¢åˆ¥å£²ä¸Šã‚°ãƒ©ãƒ•ï¼ˆv1.2ï¼‰

admin_users.php            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ï¼ˆç®¡ç†è€…å°‚ç”¨ / v1.3ï¼‰

login.php                  // ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ï¼ˆv1.3ï¼‰
login_action.php           // ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†
logout_action.php          // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆå‡¦ç†
```

---

## â–¶ ä½¿ã„æ–¹ï¼ˆHow to Useï¼‰

1. ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§PHPã¨MySQLã‚’èµ·å‹•ï¼ˆXAMPP ç­‰ï¼‰
2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆã—ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æº–å‚™
3. ãƒ–ãƒ©ã‚¦ã‚¶ã§ `deals_list.php`ï¼ˆã¾ãŸã¯ `index.php`ï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹
4. ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦é¡§å®¢ãƒ»æ¡ˆä»¶ãƒ‡ãƒ¼ã‚¿ã‚’ç™»éŒ²
5. ä¸€è¦§ç”»é¢ã§CRUDæ“ä½œã‚’å®Ÿè¡Œ
6. ã‚°ãƒ©ãƒ•ãƒšãƒ¼ã‚¸ã§é¡§å®¢åˆ¥å£²ä¸Šã‚’ç¢ºèª

---

## ğŸ“„ æ³¨æ„äº‹é …

* æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ **å­¦ç¿’ç›®çš„** ã§åˆ¶ä½œã—ã¦ã„ã¾ã™
* ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¯æœ€å°é™ã®å®Ÿè£…ã§ã™

---

---

# ğŸ—‚ Simple Deal Manager â€“ README

## ğŸ“ Overview

**Simple Deal Manager** is a simple business data management application
for registering and managing **customers** and **deal records**.

The primary goal of this project is to understand
**database operations (CRUD) using PHP and MySQL**,
by implementing the full workflow from form input to
database insertion, list display, editing, and deletion
with a minimal and readable structure.

ğŸ”¹ **Version 1.1**
The file structure was reorganized with a clear separation of responsibilities,
and edit/update (UPDATE) functionality was added to complete the CRUD cycle.

ğŸ”¹ **Version 1.2**
A dedicated chart page was added to visualize aggregated sales data by customer using **Chart.js**.

ğŸ”¹ **Version 1.3**
Login authentication and role-based access control were implemented.
Administrator-only pages were added, including a **User Management screen (`admin_users.php`)**.

---

## ğŸ¯ Learning Objectives

* Handling form submission with PHP
* Database operations using MySQL (PDO)
* Basic implementation of CRUD (Create / Read / Update / Delete)
* Designing PHP files with clear responsibility separation
* Reusing common components with `include`
* Organizing UI using component-based CSS design
* Visualizing aggregated data with Chart.js
* Designing basic login authentication and role-based access control (v1.3)

---

## ğŸ“‹ Features

### â–¼ Deal Management

* Register deal records linked to customers
* List view using SQL JOIN
* Edit & update (UPDATE)
* Multi-select delete via checkboxes

### â–¼ Customer Management (Admin Only)

* Register customers
* Display customer list
* Admin access control via `require_admin()`

### â–¼ Customer Sales Chart (Added in v1.2)

* Aggregate customer sales using **LEFT JOIN**
* Include customers with no sales as zero-value data
* Visualize results with **Chart.js**
* Rendering logic separated into an ES module:
  `assets/js/renderSalesChart.js`

### â–¼ Login Authentication & Authorization (Added in v1.3)

* User login screen
* Session-based login state management
* Only active users (`u_life_flg = 0`) can log in
* Role-based access control using `u_role_flg`

### â–¼ User Management Screen (Admin Only / v1.3)

* Display user list from `user_master`
* Show role (Admin / User) and status (Active / Disabled)
* Admin-only access control via `require_admin()`

---

## ğŸ”§ Design & Architecture Notes

This application is structured with a strong focus on
**clear separation of responsibilities and readability**.

* Database configuration is centralized in `config/db.php`
* DB connection logic is encapsulated in `db_conn()` (`inc/functions.php`)
* Shared helper functions like `h()` (escape) are centralized
* Common header is implemented as `inc/header.php`
* CSS is split by role (button / form / table / chart / login)
* Mobile header layout is adjusted to prevent button collapse  
* Table styles are shared and extended for users/deals lists 
* UI tokens (root variables) are used for consistent design control 

---

## ğŸ›  Tech Stack

* HTML
* CSS
* PHP
* MySQL
* Chart.js

---

## ğŸ—‚ Directory Structure

```
assets/
â”œâ”€ css/
â”‚  â”œâ”€ buttons.css
â”‚  â”œâ”€ chart.css
â”‚  â”œâ”€ form.css
â”‚  â”œâ”€ login.css
â”‚  â”œâ”€ responsive.css
â”‚  â”œâ”€ scroll.css
â”‚  â”œâ”€ style.css
â”‚  â””â”€ table.css
â””â”€ js/
   â””â”€ renderSalesChart.js

config/
â””â”€ db.php

inc/
â”œâ”€ functions.php
â””â”€ header.php

deals_list.php
deal_create_action.php
deal_edit.php
deal_update_action.php
deal_delete_action.php

customers_list.php
customer_create_action.php

sales_chart.php

admin_users.php

login.php
login_action.php
logout_action.php
```

---

## ğŸ“„ Notes

* This project is created **for learning purposes**
* Security measures and validation are intentionally minimal

---
